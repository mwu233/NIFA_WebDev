<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width", initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Crop Yield Prediction Map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin="" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<!--    <link rel="stylesheet" href="css/leaflet-control-bar.css" />-->
    <link rel="stylesheet" href="css/leaflet-sidebar.css" />
    <link rel="stylesheet" href="css/style.css">
    <!-- leaflet draw plugin -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.js"></script>
</head>
<body>

    <div id="sidebar" class="sidebar collapsed">
        <!-- Nav tabs -->
        <div class="sidebar-tabs">
            <ul role="tablist">
                <li><a href="#home" role="tab"><i class="fa fa-bars fa-2x"></i></a></li>
                <li><a href="#info" role="tab"><i class="fa fa-info fa-2x"></i></a></li>
<!--                <li class="disabled"><a href="#messages" role="tab"><i class="fa fa-envelope"></i></a></li>-->
                <li><a href="#filter" role="tab"><i class="fa fa-filter fa-2x"></i></a></li>
                <li><a href="#edit" role="tab"><i class="fa fa-edit fa-2x"></i></a></li>
                <li><a href="#download" role="tab"><i class="fa fa-download fa-2x"></i></a></li>
                <li><a href="#save" role="tab"><i class="fa fa-save fa-2x"></i></a></li>
                <li><a href="#profile" role="tab"><i class="fa fa-user fa-2x"></i></a></li>
                <li><a href="#messages" role="tab"><i class="fa fa-envelope fa-2x"></i></a></li>
                <li><a href="https://github.com/mwu233/NIFA_WebDev" role="tab" target="_blank"><i class="fa fa-github fa-2x"></i></a></li>
            </ul>

            <ul role="tablist">
                <li><a href="#settings" role="tab"><i class="fa fa-gear fa-2x"></i></a></li>
            </ul>
        </div>

        <!-- Tab panes -->
        <div class="sidebar-content">
            <div class="sidebar-pane" id="home">
                <h1 class="sidebar-header">
                    Project Introduction
                    <span class="sidebar-close"><i class="fa fa-caret-left"></i></span>
                </h1>
                <p>References: <a href="https://www.sciencedirect.com/science/article/abs/pii/S0034425721001267" role="tab" target="_blank">Corn yield prediction and uncertainty analysis based on remotely sensed variables using a Bayesian neural network approach</a>.</p>
                <p>In this project, we have developed models and tools to provide near real-time in-season crop yield predictions for two mainly commodity crops (i.e., corn and soybeans) at the county-level for the CONUS, based on state-of-the-art remote sensing and deep learning technologies. </p>
                <p>The predicted yield information will be disseminated through a web-based cyber-platform for free public use, which is critical for a variety of stakeholders, such as for US producers to make operational decisions; for insurance companies to help with claim and compliance assessment; for agricultural finance companies to support businesses of distribution, processing, and marketing. </p>
                <p>The predicted yield information will also be delivered to USDA for decision support to maintain the stability of the food supply and price, to reduce food security threats. The proposed tool could potentially reduce the USDA NASS survey response burden and cost, improve the efficiency and data quality, and enhance USDA NASS crop yield prediction capability. </p>
                <p>Therefore, the proposed project will add value to NASS's existing crop yield estimation program and have broad impacts on many stakeholders.</p>
            </div>
            <div class="sidebar-pane" id="info">
                <h1 class="sidebar-header">Map Information<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
                <p>This web portal is based on the libraries of Leaflet and D3 in Javascript for users to interact with our prediction results. Currently, the web map portal supports the following main functions:
                    <ul class="lorem"><!--<ul class="lorem">-->
                        <li>Presenting the general information of NIFA Corn Yield Prediction Project at the menu, e.g., introduction, publications, documentation, profiles of the research group, and the web map user guideline;</li>
                        <li>Displaying the studied areas by census tract, with crop yield prediction results rendered as a choropleth map, along with web map interaction basics such as zooming in/out;</li>
                        <li>Hovering on a census tract of interest, and its information of crop type, yield, and prediction value, date and error will be displayed in a panel at the top-right corner, along with a scatter-plot displaying the temporal changes;</li>
                        <li>Selecting a location, crop type, year, prediction date, and an attribute (i.e., crop yield value, prediction value, and prediction error), and the filtered information will be displayed on the map;</li>
                        <li>Linking to the web map Github portal for any further information.</li>
                    </ul>
                </p>
                <p>Other functions will also be developed in the next steps (but not limited to):
                    <ul class="lorem">
                        <li>Editing the map, e.g., adding features (point/line/polygon) and annotation to the map;</li>
                        <li>Saving the map with the selected information by the user;</li>
                        <li>Downloading the open-sourced map data selected by the user;</li>
                        <li>Contacting the technician for help.</li>
                    </ul>
                </p>
            </div>
            <div class="sidebar-pane" id="profile">
                <h1 class="sidebar-header">Research Group<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
                <p>Zhou Zhang, UW-Madison, zzhang347@wisc.edu; </p>
                <p>Yuchi Ma, UW-Madison, ma286@wisc.edu; </p>
                <p>Zeyu Cao, UW-Madison, zcao96@wisc.edu; </p>
                <p>Zhengwei Yang, REE-NASS, zhengwei.yang@usda.gov </p>
                <p>Qunying Huang, UW-Madison, qhuang46@wisc.edu;</p>
                <p>Meiliu Wu, UW-Madison, mwu233@wisc.edu; </p>
            </div>
            <div class="sidebar-pane" id="messages">
                <h1 class="sidebar-header">Contact<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
            </div>
            <div class="sidebar-pane" id="filter">
                <h1 class="sidebar-header">Select<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>

                <!--Location selection-->
                <div id="locationFillIn">
                    <h3 style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                        Location:
                    </h3>
                    <!--Make sure the form has the autocomplete function switched off:-->
                    <form autocomplete="off" action="/action_page.php">
                        <div class="autocomplete" style="width:300px;">
                            <input id="locationInput" type="text" name="location" placeholder="Enter a county">
                        </div>
                    </form>
                </div>

                <div id="cropSelect">
                    <h3 style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                        Crop type:
                    </h3>
                    <label for="cropInput"></label>
                    <select name="cropInput" id="cropInput" style="font-size: 16px; padding: 3px">
                        <option value="corn">Corn</option>
                        <option value="soybean">Soybean</option>
                    </select>
                </div>

                <div id="yearSelect">
                    <h3 style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                        Year:
                    </h3>
                    <label for="yearInput"></label>
                    <select name="yearInput" id="yearInput" style="font-size: 16px; padding: 3px">
                        <option value="2010">2010</option>
                        <option value="2011">2011</option>
                        <option value="2012">2012</option>
                        <option value="2013">2013</option>
                        <option value="2014">2014</option>
                        <option value="2015">2015</option>
                        <option value="2016">2016</option>
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                    </select>
                </div>

                <div id="monthSelect">
                    <h3 style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                        Date:
                    </h3>
                    <label for="monthInput"></label>
                    <select name="monthInput" id="monthInput" style="font-size: 16px; padding: 3px">
                        <option value="0">05/13</option>
                        <option value="1">05/29</option>
                        <option value="2">06/14</option>
                        <option value="3">06/30</option>
                        <option value="4">07/16</option>
                        <option value="5">08/01</option>
                        <option value="6">08/17</option>
                        <option value="7">09/02</option>
                        <option value="8">09/18</option>
                        <option value="9">10/04</option>
                    </select>
                </div>

                <div id="propertySelect">
                    <h3 style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                        Attribute:
                    </h3>
                    <label for="propertyInput"></label>
                    <select name="propertyInput" id="propertyInput" style="font-size: 16px; padding: 3px">
                        <option value="pred">Crop Prediction Values</option>
                        <option value="yield">Crop Yield Values</option>
                        <option value="error">Errors between Prediction and Yield</option>
                    </select>
                </div>

                <div id="controlButton" style="margin-top: 15px;">
                    <button class="btn apply" onclick="applySetting()" style="margin-left: 15px;">Apply Selections</button>
                </div>

                <select name="dataDownFormat" id="dataDownFormat" style="font-size: 16px; padding: 3px;margin-top: 10px">
                    <option value="csv">CSV File</option>
                    <option value="shp">ShapeFile</option>
                    <option value="json">GeoJSON File</option>
                </select>
                <div id="DataDownButton" style="margin-top: 15px;">
                    <button class="btn apply" onclick="downloadData()" style="margin-left: 15px;">Download Selections</button>
                </div>

            </div>
            <div class="sidebar-pane" id="edit">
                <h1 class="sidebar-header">Edit<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>

                <!--Location selection-->
                <div id="plotCounty">
                    <h3 style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                        Location:
                    </h3>
                    <!--Make sure the form has the autocomplete function switched off:-->
                    <form autocomplete="off" action="/action_page.php">
                        <div class="autocomplete" style="width:300px;">
                            <input id="plotCountyIn" type="text" name="location" placeholder="Enter a county">
                        </div>
                    </form>
                </div>

                <div id="plotState">
                    <h3 style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                        State:
                    </h3>
                        <div class="selector" style="width:300px;">
                            <select id="plotStateIn"  style="width:150px;"></select>
                        </div>
                </div>


                <div id="plotCrop">
                    <h3 style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                        Crop type:
                    </h3>
                    <label for="plotCropIn"></label>
                    <select name="plotCropIn" id="plotCropIn" style="font-size: 16px; padding: 3px">
                        <option value="corn">Corn</option>
                        <option value="soybean">Soybean</option>
                    </select>
                </div>

                </div>
                <div id="statistics" style="margin-bottom:0px;margin-top: 25px;margin-left: 0px;">
                </div>


            <div>
                    <button class="btn" style="background:#3630a3;color:white;" onclick="plotFunc()">
                    Plot yearly data</button>
                    <button class="btn" style="background:#3630a3;color:white;" onclick="downloadFunc('scatterP')">
                        Download Plot</button>
                </div>
                <div id="scatterP"></div>
            </div>
            <div class="sidebar-pane" id="download">
                <h1 class="sidebar-header">Download Data<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
                <p><a href="https://github.com/mwu233/NIFA_WebDev/tree/main/data" role="tab" target="_blank">Download Prediction Results</a></p>
                <p><a href="https://github.com/mwu233/NIFA_WebDev/tree/main/data" role="tab" target="_blank">Download Variables</a></p>
            </div>
            <div class="sidebar-pane" id="save">
                <h1 class="sidebar-header">Save Map<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
                <button class="btn" style="background:#3630a3;color:white;" onclick="downloadFunc('map')">
                    Download Current Map View</button>
                <div id="testdiv"></div>
            </div>
            <div class="sidebar-pane" id="settings">
                <h1 class="sidebar-header">Settings<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>
            </div>
        </div>
    </div>

    <div id="bar" class="topnav">
        <a class="active" href="#home">&nbsp&nbsp&nbsp&nbspCrop Yield Prediction Project&nbsp&nbsp&nbsp</a>
        <a href="#about">About</a>
        <a href="#help">Help</a>
        <a href="#publications">Publications</a>
        <a href="#documentation">Documentation</a>
    </div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>
    <script type="text/javascript" src="lib/jquery-3.3.1.js"></script>
    <script type="text/javascript" src="lib/dom-to-image-more.min.js"></script>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script type="text/javascript" src="lib/leaflet/leaflet-src.js"></script>
    <script type="text/javascript" src="lib/leaflet-control-bar.js"></script>
    <script type="text/javascript" src="lib/leaflet-sidebar.js"></script>
    <script type="text/javascript" src="lib/d3.v4.js"></script>
    <script type="text/javascript" src="js/main.js"></script>
    <script src="lib/dom-to-image-more.min.js">         </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.js"></script>
</body>
</html>